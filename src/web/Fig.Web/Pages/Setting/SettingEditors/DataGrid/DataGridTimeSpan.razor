@using Fig.Common.NetStandard.Scripting
@using Fig.Web.Models.Setting.ConfigurationModels.DataGrid
<RadzenTextBox Value="@TimeProxy" @oninput="SetTimeValue" @onkeydown="HandleKeyDown"/>

@code {

    [Parameter]
    public IDataGridValueModel Model { get; set; } = null!;
    
    [Parameter]
    public EventCallback OnEnterPressed { get; set; }

    private string TimeProxy
    {
        get => TimeSpanModel.Value.ToString("c");
        set
        {
            if (TimeSpan.TryParse(value, out var timeSpanValue))
            {
                TimeSpanModel.Value = timeSpanValue;
            }
        }
    }
    
    private void SetTimeValue(ChangeEventArgs args)
    {
        TimeProxy = args.Value?.ToString() ?? string.Empty;
    }

    private DataGridValueModel<TimeSpan> TimeSpanModel => (Model as DataGridValueModel<TimeSpan>)!;
    
    private async Task HandleKeyDown(KeyboardEventArgs e)
    {
        if (e.Key == "Enter")
        {
            await OnEnterPressed.InvokeAsync();
        }
    }
}