"use strict";(globalThis.webpackChunkfig_documentation=globalThis.webpackChunkfig_documentation||[]).push([[4795],{28453(e,t,n){n.d(t,{R:()=>o,x:()=>d});var i=n(96540);const s={},r=i.createContext(s);function o(e){const t=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:t},e.children)}},58529(e,t,n){n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"client-configuration","title":"Client Configuration","description":"Fig can be installed into any client type however this section will focus on asp.net style projects written in dotnet 7.","source":"@site/docs/client-configuration.md","sourceDirName":".","slug":"/client-configuration","permalink":"/docs/next/client-configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/mzbrau/fig/tree/main/doc/fig-documentation/docs/client-configuration.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Introduction","permalink":"/docs/next/intro"},"next":{"title":"Overview","permalink":"/docs/next/category/overview"}}');var s=n(74848),r=n(28453);const o={sidebar_position:2},d="Client Configuration",l={},a=[{value:"Fig Options",id:"fig-options",level:2},{value:"Command Line Arguments",id:"command-line-arguments",level:2}];function c(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"client-configuration",children:"Client Configuration"})}),"\n",(0,s.jsx)(t.p,{children:"Fig can be installed into any client type however this section will focus on asp.net style projects written in dotnet 7."}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Add the Fig.Client nuget package"}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"In your program.cs file, add the following"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-csharp",children:'var configuration = new ConfigurationBuilder()\n    .AddFig<Settings>(o =>\n    {\n        o.ClientName = "<YOUR CLIENT NAME>";\n    });\n'})}),"\n",(0,s.jsx)(t.admonition,{title:"My tip",type:"tip",children:(0,s.jsxs)(t.p,{children:["It is recommended that Fig be the ",(0,s.jsx)(t.strong,{children:"LAST"})," configuration provider added. This is because Fig will override any settings that are set in other configuration providers. If you use other configuration providers after Fig, they may overwrite settings in the application but this will not be visible from the Fig web application.\nIf you need to override a value locally, you can use the ",(0,s.jsx)(t.a,{href:"https://www.figsettings.com/docs/features/client-settings-override/",children:"client settings override"})," feature."]})}),"\n",(0,s.jsxs)(t.ol,{start:"3",children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Add an environment variable called FIG_API_URI with the URI of the Fig API. For example:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"FIG_API_URI=https://localhost:7281\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Multiple addresses separated by a comma are also supported with the first address being prioritized. Addresses are tested in order on startup and are not changed once selected."}),"\n",(0,s.jsx)(t.admonition,{title:"My tip",type:"tip",children:(0,s.jsx)(t.p,{children:"You can disable Fig by removing the FIG_API_URI environment variable. This is useful if you want to use other configuration providers instead in some environments."})}),"\n",(0,s.jsxs)(t.ol,{start:"4",children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Create a class to hold your configuration items. e.g. ",(0,s.jsx)(t.code,{children:"Settings"})," (they can be called whatever you want)"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Extend ",(0,s.jsx)(t.code,{children:"Settings"})," from ",(0,s.jsx)(t.code,{children:"SettingsBase"})]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Create a secret for your client. This must be a random string of at least 32 characters. Fig accepts 3 ways to register a secret.\nOn ",(0,s.jsx)(t.strong,{children:"Windows"}),", secrets must be stored in DPAPI and the encrypted value set in an environment variable called ",(0,s.jsx)(t.code,{children:"FIG_<CLIENT NAME>_SECRET"}),". There is a DPAPI tool included as part of the Fig release which can be used to easily generate an encrypted secret.\nIn a ",(0,s.jsx)(t.strong,{children:"Docker Container"}),", the secret must be set as a docker secret called ",(0,s.jsx)(t.code,{children:"FIG_<client name>_SECRET"}),". The file may also have a .txt extension.\nOn any other platform, it is possible to specify the secret in code, but this is ",(0,s.jsx)(t.strong,{children:"not recommended for production use"}),". It can be set in the options when registering Fig. e.g."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-csharp",children:'var configuration = new ConfigurationBuilder()\n .AddFig<Settings>(o =>\n {\n     o.ClientName = "AspNetApi";\n     o.ClientSecretOverride = "d4b0b76dfb5943f3b0ab6a7f70b6ffa0";\n });\n'})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["It is recommended that you validate the settings when they are changed. To add this functionality, add the following in ",(0,s.jsx)(t.code,{children:"program.cs"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-csharp",children:"builder.Host.UseFigValidation<Settings>();\n"})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["If you want to allow the Fig web application to be able to restart Fig, add the following in ",(0,s.jsx)(t.code,{children:"program.cs"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-csharp",children:'var configuration = new ConfigurationBuilder()\n .AddFig<Settings>(o =>\n {\n     o.ClientName = "AspNetApi";\n     o.SupportsRestart = true;\n });\n\nbuilder.Host.UseFigRestart<Settings>();\n'})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"fig-options",children:"Fig Options"}),"\n",(0,s.jsx)(t.p,{children:"There are a number of options that you can configure within Fig."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Option"}),(0,s.jsx)(t.th,{children:"Description"}),(0,s.jsx)(t.th,{children:"Example"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"LiveReload"}),(0,s.jsx)(t.td,{children:"A boolean indicating if this client should live reload its settings. If set to true the values of the properties in the settings class will be updated as soon as they are updated in the Fig web app application. Default to true."}),(0,s.jsx)(t.td,{children:"True"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"ClientSecretOverride"}),(0,s.jsx)(t.td,{children:"A string (at least 32 characters) that is unique to this application which is used to authenticate the client towards the Fig api."}),(0,s.jsxs)(t.td,{children:["e682dea03f044e0",(0,s.jsx)("br",{}),"eb571c441eb095ee9"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"VersionOverride"}),(0,s.jsxs)(t.td,{children:["By default Fig will attempt to locate the version of your application. This is used to display the version within the Fig Web Application. Fig looks at the ",(0,s.jsx)(t.code,{children:"AssemblyFileVersionAttribute"})," for version information. If your application is not versioned in this way, the version can be overridden here."]}),(0,s.jsx)(t.td,{children:"1.2"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"AllowOfflineSettings"}),(0,s.jsx)(t.td,{children:"True if offline settings should be supported. Offline settings are useful in the case the Fig API is offline and your application needs to start, it can start with the previously issued settings. Settings are stored as an encrypted blob with your client secret as the encryption key. Defaults to true."}),(0,s.jsx)(t.td,{children:"True"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"VersionType"}),(0,s.jsxs)(t.td,{children:["By default, Fig will read the assembly version of the application and provide that to the Fig API as the applications version. If different application version information is preferred, the VersionType can be set in the client options. Supported version types are ",(0,s.jsx)(t.code,{children:"Assembly"}),", ",(0,s.jsx)(t.code,{children:"File"}),", or ",(0,s.jsx)(t.code,{children:"Product"}),"."]}),(0,s.jsx)(t.td,{})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"LoggerFactory"}),(0,s.jsx)(t.td,{children:"Add a logger factory to enable logging within the Fig client."}),(0,s.jsx)(t.td,{})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"ClientSecretProviders"}),(0,s.jsxs)(t.td,{children:["An array of ",(0,s.jsx)(t.a,{href:"/docs/next/features/client-secrets/client-secret-providers",children:"client secret providers"}),"."]}),(0,s.jsx)(t.td,{children:"[new DockerSecretProvider(), new DpapiSecretProvider()]"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"CustomActionPollInterval"}),(0,s.jsx)(t.td,{children:"How frequently the Fig.Client should poll Fig.Api to check for custom action execution request."}),(0,s.jsx)(t.td,{children:"TimeSpan.FromSeconds(5)"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"AutomaticallyGenerateHeadings"}),(0,s.jsx)(t.td,{children:"By default, headings will automatically generated based on categories. It is possible to disable this functionality."}),(0,s.jsx)(t.td,{children:"True"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"ApiRequestTimeout"}),(0,s.jsx)(t.td,{children:"It is possible to change the duration of the timeout when trying to contact the Fig.Api. This can be useful if the application is not responsive enough when the Api is offline."}),(0,s.jsx)(t.td,{children:"TimeSpan.FromSeconds(2)"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"ApiRetryCount"}),(0,s.jsx)(t.td,{children:"The number of retries that should attempted before using offline settings."}),(0,s.jsx)(t.td,{children:"2"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"LookupTableRegistrationDelay"}),(0,s.jsxs)(t.td,{children:["The delay before any lookup tables are registered using the ",(0,s.jsx)(t.code,{children:"ILookupProvider"})," or ",(0,s.jsx)(t.code,{children:"IKeyedLookupProvider"})," interface."]}),(0,s.jsx)(t.td,{children:"TimeSpan.FromSeconds(30)"})]})]})]}),"\n",(0,s.jsx)(t.h2,{id:"command-line-arguments",children:"Command Line Arguments"}),"\n",(0,s.jsx)(t.p,{children:"Fig.Client supports several command line arguments that can be passed to your application:"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Argument"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"--disable-fig=true"})}),(0,s.jsx)(t.td,{children:"Disables Fig entirely. The application will start without connecting to the Fig API."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"--printappconfig"})}),(0,s.jsx)(t.td,{children:"Logs the application configuration to the console on startup. Useful for debugging."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"--secret=<value>"})}),(0,s.jsx)(t.td,{children:"Overrides the client secret. Not recommended for production use."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"--setting-definitions"})}),(0,s.jsxs)(t.td,{children:["Exports the client's setting definitions to a JSON file and exits. See ",(0,s.jsx)(t.a,{href:"/docs/next/features/client-registration-history",children:"Client Registration History"})," for details."]})]})]})]}),"\n",(0,s.jsxs)(t.p,{children:["To pass command line arguments to Fig, set the ",(0,s.jsx)(t.code,{children:"CommandLineArgs"})," option:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-csharp",children:'var configuration = new ConfigurationBuilder()\n    .AddFig<Settings>(o =>\n    {\n        o.ClientName = "MyApplication";\n        o.CommandLineArgs = args; // Pass the args from Main()\n    });\n'})})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}}}]);