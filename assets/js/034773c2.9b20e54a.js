"use strict";(self.webpackChunkfig_documentation=self.webpackChunkfig_documentation||[]).push([[2941],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>g});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},d="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=c(n),m=i,g=d["".concat(s,".").concat(m)]||d[m]||h[m]||o;return n?a.createElement(g,r(r({ref:t},u),{},{components:n})):a.createElement(g,r({ref:t},u))}));function g(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[d]="string"==typeof e?e:i,r[1]=l;for(var c=2;c<o;c++)r[c]=n[c];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8271:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var a=n(7462),i=(n(7294),n(3905));const o={sidebar_position:16},r="Web Hooks",l={unversionedId:"features/web-hooks",id:"features/web-hooks",title:"Web Hooks",description:"Fig has a web hook integration point which allows third party integrations to be called by Fig in response to certain events occurring. This allows events from Fig to be available more widely for example sent to someone via email or posted to a Slack or Teams channel.",source:"@site/docs/features/web-hooks.md",sourceDirName:"features",slug:"/features/web-hooks",permalink:"/docs/features/web-hooks",draft:!1,editUrl:"https://github.com/mzbrau/fig/tree/main/doc/fig-documentation/docs/features/web-hooks.md",tags:[],version:"current",sidebarPosition:16,frontMatter:{sidebar_position:16},sidebar:"tutorialSidebar",previous:{title:"Instances",permalink:"/docs/features/instances"},next:{title:"Memory Leak Detection",permalink:"/docs/features/memory-leak-detection"}},s={},c=[{value:"Web Hook Types",id:"web-hook-types",level:2},{value:"Web Hook Configuration",id:"web-hook-configuration",level:2},{value:"Web Hook Clients",id:"web-hook-clients",level:3},{value:"Configuring Web Hooks",id:"configuring-web-hooks",level:3}],u={toc:c},d="wrapper";function h(e){let{components:t,...o}=e;return(0,i.kt)(d,(0,a.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"web-hooks"},"Web Hooks"),(0,i.kt)("p",null,"Fig has a web hook integration point which allows third party integrations to be called by Fig in response to certain events occurring. This allows events from Fig to be available more widely for example sent to someone via email or posted to a Slack or Teams channel."),(0,i.kt)("h2",{id:"web-hook-types"},"Web Hook Types"),(0,i.kt)("p",null,"Web Hooks are currently support for the following events:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Event"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"),(0,i.kt)("th",{parentName:"tr",align:null},"Contract"),(0,i.kt)("th",{parentName:"tr",align:null},"Route (POST)"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Client Status Changed"),(0,i.kt)("td",{parentName:"tr",align:null},"When a setting client connects or is marked as disconnected this web hook will be called. Note that clients may be marked as disconnected some time after they are actually no longer running as the check is performed on the next poll for an instance of that client. The contract indicates if the the client is connecting or disconnected."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/mzbrau/fig/blob/main/src/common/Fig.WebHooks.Contracts/ClientStatusChangedDataContract.cs"},"Github")),(0,i.kt)("td",{parentName:"tr",align:null},"/ClientStatusChanged")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Setting Value Changed"),(0,i.kt)("td",{parentName:"tr",align:null},"When a setting value is updated and it matches the provided filters, this web hook will be sent. One web hook is sent per setting client that has the value changed."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/mzbrau/fig/blob/main/src/common/Fig.WebHooks.Contracts/SettingValueChangedDataContract.cs"},"Github")),(0,i.kt)("td",{parentName:"tr",align:null},"/SettingValueChanged")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Memory Leak Detected"),(0,i.kt)("td",{parentName:"tr",align:null},"Fig has a basic memory leak detection feature. When I leak is suspected, a web hook will be sent with the details of the detection. For more details on the memory leak detection, see ",(0,i.kt)("a",{parentName:"td",href:"/docs/features/memory-leak-detection"},"Memory Leak Detection"),"."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/mzbrau/fig/blob/main/src/common/Fig.WebHooks.Contracts/MemoryLeakDetectedDataContract.cs"},"Github")),(0,i.kt)("td",{parentName:"tr",align:null},"/MemoryLeakDetected")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"New Client Registration"),(0,i.kt)("td",{parentName:"tr",align:null},"When a new client is registered with Fig this web hook will be sent."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/mzbrau/fig/blob/main/src/common/Fig.WebHooks.Contracts/ClientRegistrationDataContract.cs"},"Github")),(0,i.kt)("td",{parentName:"tr",align:null},"/NewClientRegistration")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Updated Client Registration"),(0,i.kt)("td",{parentName:"tr",align:null},"When a client already known to Fig registers (the integration starts) and includes an updated setting definition this web hook is sent. This is not triggered by an unchanged registration."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/mzbrau/fig/blob/main/src/common/Fig.WebHooks.Contracts/ClientRegistrationDataContract.cs"},"Github")),(0,i.kt)("td",{parentName:"tr",align:null},"/UpdatedClientRegistration")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Minimum Run Sessions"),(0,i.kt)("td",{parentName:"tr",align:null},"Fig is able to track the number of running sessions for any client. A web hook can be configured to be sent when the number of running clients drops below a configured number. This web hook will also be sent when the minimum number is restored. Note that it is not possible to set a value of 1 for minimum run sessions. This is due to the way fig tracks the run sessions. Run sessions are considered disconnected if they have missed 2 consecutive polls. These checks are performed when another run session from the same client performs a poll. As a result, if there is only 1 run session and it disconnects, it will not be marked as disconnected (although it will be excluded when sent to the web app)."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/mzbrau/fig/blob/main/src/common/Fig.WebHooks.Contracts/MinRunSessionsDataContract.cs"},"Github")),(0,i.kt)("td",{parentName:"tr",align:null},"/MinRunSessions")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Configuration Error"),(0,i.kt)("td",{parentName:"tr",align:null},"Clients are able to report configuration errors back to Fig. When a configuration error is reported then this web hook will be sent. A web hook will also be sent when the configuration error state is cleared."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/mzbrau/fig/blob/main/src/common/Fig.WebHooks.Contracts/ClientConfigurationErrorDataContract.cs"},"Github")),(0,i.kt)("td",{parentName:"tr",align:null},"/ConfigurationError")))),(0,i.kt)("h2",{id:"web-hook-configuration"},"Web Hook Configuration"),(0,i.kt)("p",null,"Web Hooks can be configured by administrators using the Fig Web Application. "),(0,i.kt)("p",null,"Configuration is performed in two parts:"),(0,i.kt)("h3",{id:"web-hook-clients"},"Web Hook Clients"),(0,i.kt)("p",null,"Clients are web hook integrations. A client needs to be defined for each integration that should recieve web hooks. A client does not need to handle all web hook types."),(0,i.kt)("p",null,"Click 'Add Client' to add a new client. The two required fields are 'Name' and 'Base Uri'. Name is only used to associate the client with web hook configurations below. The base URI should be the address of the web hook integration. For example:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"image-20230618214022759",src:n(1913).Z,width:"2702",height:"384"})),(0,i.kt)("p",null,"Once entered, select the tick to save. Fig will generate a new secret to be used to secure the web hook integration. This information will be displayed in a popup. Be sure to copy this hashed secret value as it is only shown once (a new one can be generated if required). See the Web Hook Integration page for details of how this hashed secret can be used."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"image-20230618214330025",src:n(5653).Z,width:"1272",height:"420"})),(0,i.kt)("p",null,"At this point, it is possible to test the client using the 'Test' button. All routes will be tested so if the integration does not support all routes there may be some errors shown."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"image-20230618220614919",src:n(9621).Z,width:"1990",height:"814"})),(0,i.kt)("h3",{id:"configuring-web-hooks"},"Configuring Web Hooks"),(0,i.kt)("p",null,"Web hooks can be added using the 'Add Web Hook' button."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"image-20230618222230249",src:n(1441).Z,width:"2730",height:"672"})),(0,i.kt)("p",null,"Select a configured client and the event that should be sent. Once an event has been selected, additional configuration items will be shown. These are as follows:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Configuration Item"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"),(0,i.kt)("th",{parentName:"tr",align:null},"Example"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Setting Client Regex"),(0,i.kt)("td",{parentName:"tr",align:null},"A regular expression which can be used to filter the setting clients that will result in a web hook being sent. Web hooks will only be sent when there is a match."),(0,i.kt)("td",{parentName:"tr",align:null},".*")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Setting Name Regex"),(0,i.kt)("td",{parentName:"tr",align:null},"A regular expression which will be used to filter the setting values that are changed. A web hook will only be sent if one of the updated settings matches the regular expression."),(0,i.kt)("td",{parentName:"tr",align:null},".*")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Minimum Running"),(0,i.kt)("td",{parentName:"tr",align:null},"The minimum number of running instances of the setting client. If the number of running sessions falls below this number, a web hook will be sent. Note the minimum value is 2."),(0,i.kt)("td",{parentName:"tr",align:null},"2")))),(0,i.kt)("p",null,"Once the web hook has been configured and saved, fig will calculate the number of clients and settings that match given the configuration filters. More details of these matches can be shown by clicking the details link."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"image-20230618223538810",src:n(6737).Z,width:"2560",height:"550"})))}h.isMDXComponent=!0},1913:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20230618214022759-12711978489e1ef07936918ca9d18520.png"},5653:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20230618214330025-7c398aa3f4df5cde769a2a2a992d4ab2.png"},9621:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20230618220614919-82ad7b2e0390b028d81f12c836d864db.png"},1441:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20230618222230249-3f16d2e6af5a88c4099dbd4423e202e5.png"},6737:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20230618223538810-1a919ae35616934f0e02b39aac87049b.png"}}]);