"use strict";(self.webpackChunkfig_documentation=self.webpackChunkfig_documentation||[]).push([[7842],{3905:(e,t,i)=>{i.d(t,{Zo:()=>c,kt:()=>g});var n=i(7294);function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function a(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach((function(t){r(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function l(e,t){if(null==e)return{};var i,n,r=function(e,t){if(null==e)return{};var i,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)i=s[n],t.indexOf(i)>=0||(r[i]=e[i]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)i=s[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}var o=n.createContext({}),u=function(e){var t=n.useContext(o),i=t;return e&&(i="function"==typeof e?e(t):a(a({},t),e)),i},c=function(e){var t=u(e.components);return n.createElement(o.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},f=n.forwardRef((function(e,t){var i=e.components,r=e.mdxType,s=e.originalType,o=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=u(i),f=r,g=d["".concat(o,".").concat(f)]||d[f]||p[f]||s;return i?n.createElement(g,a(a({ref:t},c),{},{components:i})):n.createElement(g,a({ref:t},c))}));function g(e,t){var i=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=i.length,a=new Array(s);a[0]=f;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l[d]="string"==typeof e?e:r,a[1]=l;for(var u=2;u<s;u++)a[u]=i[u];return n.createElement.apply(null,a)}return n.createElement.apply(null,i)}f.displayName="MDXCreateElement"},9979:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>o,contentTitle:()=>a,default:()=>d,frontMatter:()=>s,metadata:()=>l,toc:()=>u});var n=i(7462),r=(i(7294),i(3905));const s={sidebar_position:4},a="Verifications",l={unversionedId:"features/verifications",id:"features/verifications",title:"Verifications",description:"Fig includes a framework for verifying setting values from within the UI. The setting verifications occur within the Fig API.",source:"@site/docs/features/verifications.md",sourceDirName:"features",slug:"/features/verifications",permalink:"/docs/features/verifications",draft:!1,editUrl:"https://github.com/mzbrau/fig/tree/main/packages/create-docusaurus/templates/shared/docs/features/verifications.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Groups",permalink:"/docs/features/settings-management/groups"},next:{title:"Event History",permalink:"/docs/features/event-history"}},o={},u=[{value:"Plug In Verifications",id:"plug-in-verifications",level:2},{value:"Usage",id:"usage",level:3},{value:"Example",id:"example",level:3},{value:"Dynamic Verifications",id:"dynamic-verifications",level:2},{value:"Usage",id:"usage-1",level:3},{value:"Example",id:"example-1",level:3}],c={toc:u};function d(e){let{components:t,...i}=e;return(0,r.kt)("wrapper",(0,n.Z)({},c,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"verifications"},"Verifications"),(0,r.kt)("p",null,"Fig includes a framework for verifying setting values from within the UI. The setting verifications occur within the Fig API."),(0,r.kt)("p",null,"There are 2 types of verification: plug in and dynamic."),(0,r.kt)("h2",{id:"plug-in-verifications"},"Plug In Verifications"),(0,r.kt)("p",null,"Plug in verifications are defined in a dll file placed in a folder called 'plugins' within the base directory of the API. "),(0,r.kt)("p",null,"The plugin definition must implement in the ",(0,r.kt)("inlineCode",{parentName:"p"},"ISettingPluginVerifier")," interface which is defined in the ",(0,r.kt)("inlineCode",{parentName:"p"},"Fig.Api.SettingVerification.Sdk")," project. Plug in verifiers can recieve the values of more than one setting which are passed in as a list of object params into the verifier."),(0,r.kt)("p",null,"Many verifications can be defined within the same assembly."),(0,r.kt)("p",null,"Fig comes with some built in plug in verifications including ",(0,r.kt)("inlineCode",{parentName:"p"},"PingVerifier")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"Rest200OkVerifier"),"."),(0,r.kt)("h3",{id:"usage"},"Usage"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c#"},'[Verification("Rest200OkVerifier", nameof(WebsiteAddress))]\npublic class ProductService : SettingsBase\n{\n    public override string ClientName => "ProductService";\n\n    [Setting("This is the address of a website", "http://www.google.com")]\n    public string WebsiteAddress { get; set; }\n}\n')),(0,r.kt)("h3",{id:"example"},"Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c#"},'public class Rest200OkVerifier : ISettingPluginVerifier\n{\n    public string Name => "Rest200OkVerifier";\n\n    public string Description =>\n        "Makes a GET request to the provided endpoint. " +\n        "Result is considered success if a status code 200 Ok response is received";\n    \n    public VerificationResult RunVerification(params object[] parameters)\n    {\n        if (parameters.Length != 1 || string.IsNullOrEmpty(parameters[0] as string))\n        {\n            return VerificationResult.IncorrectParameters();\n        }\n\n        var result = new VerificationResult();\n        var uri = parameters[0] as string;\n\n        using HttpClient client = new HttpClient();\n        \n        result.AddLog($"Performing get request to address: {uri}");\n        var requestResult = client.GetAsync(uri).Result;\n\n        if (requestResult.StatusCode == HttpStatusCode.OK)\n        {\n            result.Message = "Succeeded";\n            result.Success = true;\n            return result;\n        }\n    \n        result.AddLog($"Request failed. {requestResult.StatusCode}. {requestResult.ReasonPhrase}");\n        result.Message = $"Failed with response: {requestResult.StatusCode}";\n        return result;\n    }\n}\n')),(0,r.kt)("h2",{id:"dynamic-verifications"},"Dynamic Verifications"),(0,r.kt)("p",null,"Dynamic verifications are defined within the setting client. Fig will decompile the code and send it as text to the Fig API. When the verification is requested, fig will recompile the code and execute it. The dynamic verification will receive a dictionary of setting name and setting values to be used for the verification. "),(0,r.kt)("p",null,"Dynamic verifications must implement the ",(0,r.kt)("inlineCode",{parentName:"p"},"ISettingVerification")," interface which is defined in the ",(0,r.kt)("inlineCode",{parentName:"p"},"Fig.Client")," nuget package."),(0,r.kt)("p",null,"Dynamic verifications may be seen as a security issue as they technically allow remote code execution. If you do not trust the setting clients accessing fig, dynamic verifications should be disabled in the fig configuration page."),(0,r.kt)("h3",{id:"usage-1"},"Usage"),(0,r.kt)("p",null,"The parameters are:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Name"),(0,r.kt)("li",{parentName:"ul"},"Description"),(0,r.kt)("li",{parentName:"ul"},"The verifier type"),(0,r.kt)("li",{parentName:"ul"},"The target runtime (Note only dotnet 6 has been tested)"),(0,r.kt)("li",{parentName:"ul"},"The name of the setting(s) beng verified")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c#"},'[Verification("WebsiteVerifier", "VerifiesWebsites", typeof(WebsiteVerifier), TargetRuntime.Dotnet6, nameof(WebsiteAddress))]\npublic class ProductService : SettingsBase\n{\n    public override string ClientName => "ProductService";\n\n    [Setting("This is the address of a website", "http://www.google.com")]\n    public string WebsiteAddress { get; set; }\n}\n')),(0,r.kt)("h3",{id:"example-1"},"Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c#"},'public class CheckWebsiteVerification : ISettingVerification\n{\n    private const string WebsiteAddress = "WebsiteAddress";\n\n    public VerificationResultDataContract PerformVerification(IDictionary<string, object?> settingValues)\n    {\n        var result = new VerificationResultDataContract();\n        using HttpClient client = new HttpClient();\n\n        if (!settingValues.ContainsKey(WebsiteAddress))\n        {\n            result.Message = "No Setting Found";\n            return result;\n        }\n\n        result.AddLog($"Performing get request to address: {settingValues[WebsiteAddress]}");\n        var requestResult = client.GetAsync((string?) settingValues[WebsiteAddress]).Result;\n\n        if (requestResult.StatusCode == HttpStatusCode.OK)\n        {\n            result.Message = "Succeeded";\n            result.Success = true;\n            return result;\n        }\n    \n        result.AddLog($"Request failed. {requestResult.StatusCode}. {requestResult.ReasonPhrase}");\n        result.Message = $"Failed with response: {requestResult.StatusCode}";\n        return result;\n    }\n}\n')))}d.isMDXComponent=!0}}]);