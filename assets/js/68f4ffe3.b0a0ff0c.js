"use strict";(self.webpackChunkfig_documentation=self.webpackChunkfig_documentation||[]).push([[3263],{1936:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/custom-actions-result-ecce22dc334fbff130cc1dd7299eb0cd.png"},3131:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/custom-action-architecture-e215225b4be51140283e2b902e7d526b.png"},4724:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/custom-actions-a2f9221eb30d52b642810d792c701767.png"},5339:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/custom-actions-history-2c3d66b16b9298165324e37acc5dc3cb.png"},8087:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/custom-actions-session-cb39e8eedfbfe261d9c4c28c96097211.png"},8453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>r});var i=n(6540);const s={},c=i.createContext(s);function a(e){const t=i.useContext(c);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(c.Provider,{value:t},e.children)}},9707:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>r,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"features/custom-actions","title":"Custom Actions","description":"Custom Actions in Fig allow you to define executable operations in your applications that can be triggered from the Fig web interface. These actions provide a way to perform administrative tasks, maintenance operations, query information, diagnostics checks or other custom behaviors directly from your settings management interface.","source":"@site/docs/features/27-custom-actions.md","sourceDirName":"features","slug":"/features/custom-actions","permalink":"/docs/features/custom-actions","draft":false,"unlisted":false,"editUrl":"https://github.com/mzbrau/fig/tree/main/doc/fig-documentation/docs/features/27-custom-actions.md","tags":[],"version":"current","sidebarPosition":27,"frontMatter":{"sidebar_position":27,"sidebar_label":"Custom Actions"},"sidebar":"tutorialSidebar","previous":{"title":"Azure Key Vault Integration","permalink":"/docs/features/azure-keyvault-integration"},"next":{"title":"Client Secrets","permalink":"/docs/category/client-secrets"}}');var s=n(4848),c=n(8453);const a={sidebar_position:27,sidebar_label:"Custom Actions"},r="Custom Actions",o={},l=[{value:"Overview",id:"overview",level:2},{value:"Implementation",id:"implementation",level:2},{value:"Creating a Custom Action",id:"creating-a-custom-action",level:3},{value:"Returning results as part of the action",id:"returning-results-as-part-of-the-action",level:3},{value:"Text Results",id:"text-results",level:4},{value:"Data Grid Result",id:"data-grid-result",level:4},{value:"Registration and Dependency Injection",id:"registration-and-dependency-injection",level:2},{value:"User Interface",id:"user-interface",level:2},{value:"Running a custom actions",id:"running-a-custom-actions",level:3},{value:"Custom Action History",id:"custom-action-history",level:3},{value:"Execution Flow",id:"execution-flow",level:2},{value:"Execution States",id:"execution-states",level:3},{value:"Instance Selection",id:"instance-selection",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Potential Use Cases",id:"potential-use-cases",level:2}];function d(e){const t={br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"custom-actions",children:"Custom Actions"})}),"\n",(0,s.jsx)(t.p,{children:"Custom Actions in Fig allow you to define executable operations in your applications that can be triggered from the Fig web interface. These actions provide a way to perform administrative tasks, maintenance operations, query information, diagnostics checks or other custom behaviors directly from your settings management interface."}),"\n",(0,s.jsx)(t.p,{children:"It is a way of adding a simple user interface to back end services."}),"\n",(0,s.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(t.p,{children:"Custom Actions are client-side operations that:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Are defined and implemented within your application"}),"\n",(0,s.jsx)(t.li,{children:"Are registered automatically with the Fig API when your application starts"}),"\n",(0,s.jsx)(t.li,{children:"Can be executed on-demand from the Fig web interface"}),"\n",(0,s.jsx)(t.li,{children:"Return structured results including text output and data grids"}),"\n",(0,s.jsx)(t.li,{children:"Support execution targeting specific client instances"}),"\n",(0,s.jsx)(t.li,{children:"Provide execution history and status tracking"}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"implementation",children:"Implementation"}),"\n",(0,s.jsx)(t.h3,{id:"creating-a-custom-action",children:"Creating a Custom Action"}),"\n",(0,s.jsxs)(t.p,{children:["Custom Actions implement the ",(0,s.jsx)(t.code,{children:"ICustomAction"})," interface:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-csharp",children:'using Fig.Client.CustomActions;\nusing System.Runtime.CompilerServices;\n\npublic class FailoverAction : ICustomAction\n{\n    public string Name => "Failover";\n    public string ButtonName => "Perform Failover";\n    public string Description => "Fail over to another instance of the service.";\n    public IEnumerable<string> SettingsUsed => ["DatabaseConnectionString", "BackupEndpoint"];\n\n    public async IAsyncEnumerable<CustomActionResultModel> Execute([EnumeratorCancellation] CancellationToken cancellationToken)\n    {\n        yield return ResultBuilder.CreateSuccessResult("Failover Initiated");\n    }\n}\n'})}),"\n",(0,s.jsx)(t.h3,{id:"returning-results-as-part-of-the-action",children:"Returning results as part of the action"}),"\n",(0,s.jsx)(t.p,{children:"Actions return a collection of results. Each result can contain:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Name"}),"\n",(0,s.jsx)(t.li,{children:"Text Result"}),"\n",(0,s.jsx)(t.li,{children:"Data Grid Result"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Results can be created directly but there is a builder which simplifies the process."}),"\n",(0,s.jsx)(t.h4,{id:"text-results",children:"Text Results"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-csharp",children:'ResultBuilder.CreateSuccessResult("Database Migration")\n            .WithTextResult("Database migration completed successfully.");\n'})}),"\n",(0,s.jsx)(t.h4,{id:"data-grid-result",children:"Data Grid Result"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-csharp",children:'var migrationResults = new List<MigrationResult>\n        {\n            new("001_CreateUserTable", "Completed", DateTime.UtcNow.AddMinutes(-5)),\n            new("002_AddIndexes", "Completed", DateTime.UtcNow.AddMinutes(-3)),\n            new("003_UpdateSchema", "Completed", DateTime.UtcNow.AddMinutes(-1))\n        };\n\n        yield return ResultBuilder.CreateSuccessResult("Database Migration")\n            .WithDataGridResult(migrationResults);\n\npublic record MigrationResult(string Migration, string Status, DateTime Timestamp);\n'})}),"\n",(0,s.jsx)(t.p,{children:"It is also possible to return both a text and data grid result in the same result object."}),"\n",(0,s.jsx)(t.h2,{id:"registration-and-dependency-injection",children:"Registration and Dependency Injection"}),"\n",(0,s.jsx)(t.p,{children:"All actions must be registered with the dependency injection container so they can be discovered by Fig. For example:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-csharp",children:"builder.Services.AddSingleton<ICustomAction, FailoverAction>();\nbuilder.Services.AddSingleton<ICustomAction, DatabaseMigrationAction>();\nbuilder.Services.AddSingleton<ICustomAction, ClearCacheAction>();\n"})}),"\n",(0,s.jsx)(t.h2,{id:"user-interface",children:"User Interface"}),"\n",(0,s.jsx)(t.p,{children:"Custom actions live below all the settings for a client."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.img,{alt:"Custom Actions",src:n(4724).A+"",width:"2070",height:"790"}),(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.em,{children:"Custom actions are listed below settings"})]}),"\n",(0,s.jsx)(t.p,{children:"When executing a custom action, you can select a session. It can either be 'Auto' or a specific running instance of the application. If auto is selected, Fig will perform the action with the first available instance."}),"\n",(0,s.jsx)(t.h3,{id:"running-a-custom-actions",children:"Running a custom actions"}),"\n",(0,s.jsx)(t.p,{children:"Custom actions can be run by clicking the button. The execution state will be shown beside the button and the results below."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.img,{alt:"completed custom action",src:n(1936).A+"",width:"2064",height:"1054"}),(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.em,{children:"Completed custom action with both a text and data grid result"})]}),"\n",(0,s.jsx)(t.h3,{id:"custom-action-history",children:"Custom Action History"}),"\n",(0,s.jsx)(t.p,{children:"Previous executions can be viewed by pushing the history button. By default, the last hour is shown but that can be adjusted using the date time pickers."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"custom action history",src:n(5339).A+"",width:"2062",height:"1394"})}),"\n",(0,s.jsx)(t.h2,{id:"execution-flow",children:"Execution Flow"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"User Triggers Action"}),": User clicks the action button in the Fig web interface"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Server Queues Request"}),": Fig server creates an execution request"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Web Application Polls"}),": The web application starts to poll for results or updates"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Client Polls"}),": Running client instances poll for pending execution requests"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Action Execution"}),": The appropriate client executes the matching custom action"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Results Submission"}),": Client submits results back to the Fig server"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"UI Updates"}),": Web interface displays the results on the next poll"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Clients that have registered custom actions poll the server every 5 seconds (by default).\nWeb applications awaiting custom action results poll the server every second until results are available."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.img,{alt:"Custom Action Execution",src:n(3131).A+"",width:"1095",height:"443"}),(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.em,{children:"The different components involved in a custom action execution"})]}),"\n",(0,s.jsx)(t.p,{children:"Clients that do not have custom actions do not poll for status."}),"\n",(0,s.jsx)(t.h3,{id:"execution-states",children:"Execution States"}),"\n",(0,s.jsx)(t.p,{children:"Custom actions progress through several states:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Submitted"}),": Action execution request created in Fig server"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Sent to Client"}),": Request picked up by a running client instance"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Completed"}),": Action execution finished (success or failure)"]}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"instance-selection",children:"Instance Selection"}),"\n",(0,s.jsx)(t.p,{children:"When executing actions, you can choose:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Auto"}),": Fig automatically selects an available client instance"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Specific Instance"}),": Target a particular running instance by its session ID"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"alt text",src:n(8087).A+"",width:"2068",height:"408"})}),"\n",(0,s.jsx)(t.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(t.p,{children:"Custom actions do not have any specific configuration but as they are loaded by the DI container, they can have the settings injected and settings can be used as parameters for the custom actions."}),"\n",(0,s.jsx)(t.h2,{id:"potential-use-cases",children:"Potential Use Cases"}),"\n",(0,s.jsx)(t.p,{children:"Custom actions could be used for anything, but here are a few ideas:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Migrating databases"}),"\n",(0,s.jsx)(t.li,{children:"Failing over between instances"}),"\n",(0,s.jsx)(t.li,{children:"Performing diagnostics checks"}),"\n",(0,s.jsxs)(t.li,{children:["Fetching information about the applications","\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Number of rows in the database"}),"\n",(0,s.jsx)(t.li,{children:"Number of items cached"}),"\n",(0,s.jsx)(t.li,{children:"Time until next execution"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.li,{children:"A trigger to send or fetch information from an external system"}),"\n",(0,s.jsx)(t.li,{children:"A refresh"}),"\n",(0,s.jsx)(t.li,{children:"Invalidate a cache"}),"\n"]})]})}function u(e={}){const{wrapper:t}={...(0,c.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);