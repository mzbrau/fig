"use strict";(self.webpackChunkfig_documentation=self.webpackChunkfig_documentation||[]).push([[3560],{18519:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"guides/api-secret-migration","title":"API Secret Migration","description":"The API Secret is used to sign and verify login tokens as well as to encrypt data within the database.","source":"@site/docs/guides/1-api-secret-migration.md","sourceDirName":"guides","slug":"/guides/api-secret-migration","permalink":"/docs/next/guides/api-secret-migration","draft":false,"unlisted":false,"editUrl":"https://github.com/mzbrau/fig/tree/main/doc/fig-documentation/docs/guides/1-api-secret-migration.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Guides","permalink":"/docs/next/category/guides"},"next":{"title":"Client Secret Migration","permalink":"/docs/next/guides/client-secret-migration"}}');var s=i(74848),o=i(28453);const r={sidebar_position:1},a="API Secret Migration",c={},d=[];function l(e){const t={code:"code",h1:"h1",header:"header",li:"li",ol:"ol",p:"p",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"api-secret-migration",children:"API Secret Migration"})}),"\n",(0,s.jsx)(t.p,{children:"The API Secret is used to sign and verify login tokens as well as to encrypt data within the database."}),"\n",(0,s.jsx)(t.p,{children:"It is good practice to change the secret periodically to mitigate any risk associated with the secret being compromised. This guide explains how the secret should be changed."}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"Verify that you do not have any deferred imports that have encrypted values."}),"\n",(0,s.jsx)(t.li,{children:"Generate a new API secret. The secret can be anything but a good approach might be to concatenate a few guids together."}),"\n",(0,s.jsxs)(t.li,{children:["For each Fig API instance, copy the secret value to the PreviousSecret value and add your new secret to the secret value. You should do this wherever the API is configured, this could be in the ",(0,s.jsx)(t.code,{children:"appSettings.json"})," file, environment variables or docker secrets."]}),"\n",(0,s.jsx)(t.li,{children:"Once all API instances have been updated, it should still be possible to use Fig. User sessions generated with the old secret are still respected and all data in the database can still be decrypted with the previous secret. Any new data added will be encrypted with the new secret."}),"\n",(0,s.jsx)(t.li,{children:"Log into the web application as an administrator role and select the configuration page."}),"\n",(0,s.jsx)(t.li,{children:"Take note of the number of event logs that need to be migrated. In testing, it seemed to take about 10 seconds per 1000 logs to migrate but this is likely to be quickly with a release build and on faster machines."}),"\n",(0,s.jsx)(t.li,{children:"Press the migrate button, you will get a notification when the migration is complete."}),"\n",(0,s.jsx)(t.li,{children:"Once migration is complete, you can remove the previous secret. Note that removing it will log out any users who logged in before the secret change."}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},28453:(e,t,i)=>{i.d(t,{R:()=>r,x:()=>a});var n=i(96540);const s={},o=n.createContext(s);function r(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);