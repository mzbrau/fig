"use strict";(self.webpackChunkfig_documentation=self.webpackChunkfig_documentation||[]).push([[6161],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=o.createContext({}),l=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},u=function(e){var t=l(e.components);return o.createElement(c.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},g=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=l(n),g=r,h=p["".concat(c,".").concat(g)]||p[g]||d[g]||i;return n?o.createElement(h,a(a({ref:t},u),{},{components:n})):o.createElement(h,a({ref:t},u))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,a=new Array(i);a[0]=g;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s[p]="string"==typeof e?e:r,a[1]=s;for(var l=2;l<i;l++)a[l]=n[l];return o.createElement.apply(null,a)}return o.createElement.apply(null,n)}g.displayName="MDXCreateElement"},632:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var o=n(7462),r=(n(7294),n(3905));const i={sidebar_position:1},a="Web Hook Integrations",s={unversionedId:"integration points/web-hook-integration",id:"integration points/web-hook-integration",title:"Web Hook Integrations",description:"Fig has an integration point which allows notifications to be sent as a result of certain events occurring within the system. For details on how web hooks can be configured, see Web Hooks.",source:"@site/docs/integration points/web-hook-integration.md",sourceDirName:"integration points",slug:"/integration points/web-hook-integration",permalink:"/docs/integration points/web-hook-integration",draft:!1,editUrl:"https://github.com/mzbrau/fig/tree/main/doc/fig-documentation/docs/integration points/web-hook-integration.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Integration Points",permalink:"/docs/category/integration-points"},next:{title:"Lookup Table Integrations",permalink:"/docs/integration points/lookup-table-integration"}},c={},l=[{value:"Security",id:"security",level:2}],u={toc:l},p="wrapper";function d(e){let{components:t,...n}=e;return(0,r.kt)(p,(0,o.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"web-hook-integrations"},"Web Hook Integrations"),(0,r.kt)("p",null,"Fig has an integration point which allows notifications to be sent as a result of certain events occurring within the system. For details on how web hooks can be configured, see ",(0,r.kt)("a",{parentName:"p",href:"/docs/features/web-hooks"},"Web Hooks"),"."),(0,r.kt)("p",null,"Web hooks are sent as a POST with each type of web hook being called on a separate route. Integrations will need to listen to POST's on at least one of these routes."),(0,r.kt)("p",null,"Contracts are not mandatory and can be recreated from the json documents if required but they are published as a nuget package for use by integrations. This can be found here."),(0,r.kt)("h2",{id:"security"},"Security"),(0,r.kt)("p",null,"Web hook integrations may be used without security but to avoid unauthorized parties calling the integration it is recommended that calls to the integration be validated. Fig has support for a pre-shared secret which will be passed with each web hook call. A hashed version of the secret is provided when the client is created in the Fig web application and this can be used to validate the call."),(0,r.kt)("p",null,"There are a number of ways that the secret can be checked but one possible way is provided below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c#"},'public class FigWebHookAuthMiddleware\n{\n    private readonly RequestDelegate _next;\n    private readonly ISettings _settings;\n\n    public FigWebHookAuthMiddleware(RequestDelegate next, ISettings settings)\n    {\n        _next = next;\n        _settings = settings;\n    }\n\n    public async Task Invoke(HttpContext context)\n    {\n        var secret = context.Request.Headers["Authorization"].FirstOrDefault()?.Split(" ").Last();\n        if (string.IsNullOrWhiteSpace(secret) ||\n            !BCrypt.Net.BCrypt.EnhancedVerify(secret, _settings.HashedSecret))\n        {\n            context.Response.StatusCode = (int)HttpStatusCode.Unauthorized;\n        }\n        else\n        {\n            await _next(context);\n        }\n    }\n}\n')),(0,r.kt)("p",null,"This is drawn from the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/mzbrau/fig/blob/main/src/integrations/Fig.Integration.ConsoleWebHookHandler/Middleware/FigWebHookAuthMiddleware.cs"},"example integration")," on Github."))}d.isMDXComponent=!0}}]);