"use strict";(self.webpackChunkfig_documentation=self.webpackChunkfig_documentation||[]).push([[4884],{81867:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"security","title":"Security Features","description":"Fig has a number of security features to ensure your settings remain safe.","source":"@site/docs/security.md","sourceDirName":".","slug":"/security","permalink":"/docs/next/security","draft":false,"unlisted":false,"editUrl":"https://github.com/mzbrau/fig/tree/main/doc/fig-documentation/docs/security.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Lookup Table Integrations","permalink":"/docs/next/integration-points/lookup-table-integration"},"next":{"title":"Database","permalink":"/docs/next/database"}}');var t=i(74848),r=i(28453);const o={sidebar_position:5},a="Security Features",l={},d=[{value:"SIEM Integration",id:"siem-integration",level:2},{value:"Security Events",id:"security-events",level:3},{value:"Setting Up SIEM Integration",id:"setting-up-siem-integration",level:3},{value:"Example Security Event",id:"example-security-event",level:3},{value:"Rate Limiting",id:"rate-limiting",level:2},{value:"Forward Headers",id:"forward-headers",level:2},{value:"Security Recommendations",id:"security-recommendations",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"security-features",children:"Security Features"})}),"\n",(0,t.jsx)(n.p,{children:"Fig has a number of security features to ensure your settings remain safe."}),"\n",(0,t.jsx)(n.p,{children:"Features include:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"All settings values are encrypted in the database using the server secret as the encryption key"}),"\n",(0,t.jsx)(n.li,{children:"Fig web application is protected with user credentials"}),"\n",(0,t.jsx)(n.li,{children:"Admin user can be forced to change password on first login"}),"\n",(0,t.jsxs)(n.li,{children:["Fig only accepts 'good' passwords as rated by ",(0,t.jsx)(n.a,{href:"https://github.com/dropbox/zxcvbn",children:"zxcvbn"})]}),"\n",(0,t.jsx)(n.li,{children:"Secret setting values are never sent to the Fig Web Application"}),"\n",(0,t.jsxs)(n.li,{children:["Clients must use their secret to access their settings","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Secrets can be securely stored in a number of different locations"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"All actions are logged and recorded in the database"}),"\n",(0,t.jsxs)(n.li,{children:["Offline settings files are encrypted using the client secrets","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Offline settings can also be disabled"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"File imports can be disabled"}),"\n",(0,t.jsx)(n.li,{children:"New setting registrations can be disabled"}),"\n",(0,t.jsx)(n.li,{children:"User roles only have access to setting and history information (minus user activity)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"siem-integration",children:"SIEM Integration"}),"\n",(0,t.jsx)(n.p,{children:"Fig provides built-in integration with Security Information and Event Management (SIEM) systems through webhooks. This allows organizations to monitor security events in real-time and integrate Fig with their existing security infrastructure."}),"\n",(0,t.jsx)(n.h3,{id:"security-events",children:"Security Events"}),"\n",(0,t.jsx)(n.p,{children:"Fig automatically generates security events for the following activities:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Login attempts"})," (both successful and failed)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"User creation"})," (when new users are registered)"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Each security event includes:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Event Type"}),': The type of security event (e.g., "Login")']}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Timestamp"}),": UTC timestamp when the event occurred"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Username"}),": The username associated with the event"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Success"}),": Whether the operation was successful"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"IP Address"}),": The IP address of the client making the request"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Hostname"}),": The hostname of the client making the request"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Failure Reason"}),": If the operation failed, the reason for failure"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"setting-up-siem-integration",children:"Setting Up SIEM Integration"}),"\n",(0,t.jsx)(n.p,{children:"To integrate Fig with your SIEM system:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Create a webhook endpoint"})," in your SIEM system or middleware that can receive HTTP POST requests"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Register the webhook"})," in Fig by navigating to the webhooks section in the web interface"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:'Select "Security Event"'})," as the webhook type"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Configure the endpoint URL"})," where Fig should send security events"]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{title:"Sentinel Integration",type:"note",children:(0,t.jsxs)(n.p,{children:["If you are using Microsoft Sentinel, there is a built in integration. You can find it ",(0,t.jsx)(n.a,{href:"/docs/next/integrations/fig-sentinel-connector",children:"here"}),"."]})}),"\n",(0,t.jsx)(n.h3,{id:"example-security-event",children:"Example Security Event"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "eventType": "Login",\n  "timestamp": "2024-01-15T10:30:00Z",\n  "username": "admin",\n  "success": false,\n  "ipAddress": "192.168.1.100",\n  "hostname": "workstation-01",\n  "failureReason": "Invalid password"\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"rate-limiting",children:"Rate Limiting"}),"\n",(0,t.jsx)(n.p,{children:"Fig includes configurable rate limiting to protect against denial-of-service attacks and excessive API usage. Rate limiting is implemented using ASP.NET Core's built-in rate limiting middleware with a sliding window algorithm."}),"\n",(0,t.jsxs)(n.p,{children:["Rate limiting is configured in the ",(0,t.jsx)(n.code,{children:"ApiSettings"})," section of your configuration:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "ApiSettings": {\n    "RateLimiting": {\n      "GlobalPolicy": {\n        "Enabled": true,\n        "PermitLimit": 500,\n        "Window": "00:01:00",\n        "ProcessingOrder": "OldestFirst",\n        "QueueLimit": 10\n      }\n    }\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Enabled"}),": Whether rate limiting is active"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"PermitLimit"}),": Maximum number of requests allowed within the time window"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Window"}),": Time window duration (format: HH:MM",":SS",")"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"ProcessingOrder"}),": How queued requests are processed when limits are exceeded"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"QueueLimit"}),": Number of requests that can be queued when the limit is reached"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"When rate limits are exceeded, clients receive an HTTP 429 (Too Many Requests) response with a descriptive error message."}),"\n",(0,t.jsx)(n.h2,{id:"forward-headers",children:"Forward Headers"}),"\n",(0,t.jsxs)(n.p,{children:["When Fig is deployed behind a reverse proxy or load balancer, the original client IP address and protocol information may be lost. Forward headers configuration allows Fig to trust and process ",(0,t.jsx)(n.code,{children:"X-Forwarded-For"})," and ",(0,t.jsx)(n.code,{children:"X-Forwarded-Proto"})," headers from known proxies."]}),"\n",(0,t.jsxs)(n.p,{children:["Forward headers are configured in the ",(0,t.jsx)(n.code,{children:"ApiSettings"})," section:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "ApiSettings": {\n    "TrustForwardedHeaders": true,\n    "KnownProxies": [\n      "192.168.1.10",\n      "10.0.0.5"\n    ],\n    "KnownNetworks": [\n      "192.168.1.0/24",\n      "10.0.0.0/8"\n    ]\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"TrustForwardedHeaders"}),": Whether to process forwarded headers"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"KnownProxies"}),": Specific IP addresses of trusted proxies"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"KnownNetworks"}),": Network ranges of trusted proxies (CIDR notation)"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Only forwarded headers from explicitly configured proxies and networks are trusted. This prevents IP spoofing attacks where malicious clients could manipulate forwarded headers."}),"\n",(0,t.jsx)(n.h2,{id:"security-recommendations",children:"Security Recommendations"}),"\n",(0,t.jsx)(n.p,{children:"The following recommendations will ensure your application settings are as safe as possible."}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Use secret settings"})," - Secret settings are not sent down to the web client and not shown once they are entered. They should be used for passwords, keys and any other sensitive values."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"HTTPS everywhere"})," - Fig should be deployed with HTTP for both API and Client. Setting values are transmitted unencrypted to the setting clients so HTTPS will ensure those values cannot be intercepted while in transit."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Disabling the administrator login"})," - Fig ships with an administrator login 'admin' with 'admin' as the password. The API can be configured to require a password change for that user on first login. The user can also be removed and replace with other administrative logins."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Strong Passwords"})," - Fig has a password rating view where you set your password. It will not accept any passwords rated worse than 'Good'."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Dedicated user accounts"})," - Each user of fig should be allocated their own account. This will ensure the audit log accurately reflects who made the change. If all changes are made by Admin it won't add much value."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"SQL Server Security"})," - Fig uses Sqllite out of the box but should be changed to SQL server for production deployments. All setting values are encrypted in the sql database but it is good to ensure that is also secure."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Disabling new registrations"})," - The Fig registration endpoint is unsecured. This means any client is able to register with Fig. It is possible to turn off new client registrations and this should be done in production once all known clients have registered with Fig."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Rolling API Secret"})," - The API secret is used to sign login tokens as well as encrypt all settings in the database. It can be changed at any time, however the old client secret must be retained to decrypt existing values in the database. See ",(0,t.jsx)(n.a,{href:"http://www.figsettings.com/docs/guides/api-secret-migration",children:"the guide"})," for steps."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Protect API Secret"})," - If the API secret is compromised then it will be possible to decrypt values in the database (assuming that they can access the database). It is important that it be protected either by storing it in DPAPI (Windows only) or as a docker secret."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Changing client secrets"})," - Client secrets can be changed during runtime using the web client. Clients need to be updated within the grace period. See ",(0,t.jsx)(n.a,{href:"http://www.figsettings.com/docs/guides/client-secret-migration",children:"the guide"})," for steps."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Protect client secrets"})," - Client secrets protect the values for that client and as a result, they should be kept secret. Fig supports 4 ways of reading client secrets. For windows installations, the DPAPI is the recommended way to store secrets. It will protect them for the user. For other installations, a secret store pushing to an environment variable or appsettings.json file is recommended."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Web Hook Alerts"})," - Setting up web hook alerts will ensure you are kept informed if settings are changed."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Disable Client Overrides"})," - If client overrides are not being used, disable this feature or at least limit it to the clients that should have access. This can avoid unwanted consequences."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Enable TLS"})," - Fig supports TLS for both the Web and Api instances. See ",(0,t.jsx)(n.a,{href:"http://www.figsettings.com/docs/guides/configuring-tls",children:"the guide"})," for steps and example config."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>a});var s=i(96540);const t={},r=s.createContext(t);function o(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);