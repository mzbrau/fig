"use strict";(globalThis.webpackChunkfig_documentation=globalThis.webpackChunkfig_documentation||[]).push([[4480],{2926(e,n,i){i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"features/client-settings-override","title":"Client Settings Overrides","description":"In some situations you want the settings to be driven by the client. For example when deploying applications using Docker compose if you have address to other containers within the compose file, you can reference them by their container name. In that case, you would like the setting to be set by the docker compose file rather than having to be manually set in Fig or use a default.","source":"@site/docs/features/23-client-settings-override.md","sourceDirName":"features","slug":"/features/client-settings-override","permalink":"/docs/next/features/client-settings-override","draft":false,"unlisted":false,"editUrl":"https://github.com/mzbrau/fig/tree/main/doc/fig-documentation/docs/features/23-client-settings-override.md","tags":[],"version":"current","sidebarPosition":23,"frontMatter":{"sidebar_position":23,"sidebar_label":"Client Settings Overrides"},"sidebar":"tutorialSidebar","previous":{"title":"Externally Managed Settings","permalink":"/docs/next/features/externally-managed-settings"},"next":{"title":"Environment Variables","permalink":"/docs/next/features/environment-variables"}}');var s=i(74848),a=i(28453);const r={sidebar_position:23,sidebar_label:"Client Settings Overrides"},l="Client Settings Overrides",o={},c=[{value:"Environment Variable Naming Convention",id:"environment-variable-naming-convention",level:2},{value:"Simple Settings",id:"simple-settings",level:3},{value:"Configuration Section Overrides",id:"configuration-section-overrides",level:3},{value:"Nested Settings",id:"nested-settings",level:3},{value:"List Settings",id:"list-settings",level:3},{value:"Complex Object Settings (JSON)",id:"complex-object-settings-json",level:3},{value:"Example Usage",id:"example-usage",level:2},{value:"Externally Managed Settings",id:"externally-managed-settings",level:2},{value:"Configuration",id:"configuration",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"client-settings-overrides",children:"Client Settings Overrides"})}),"\n",(0,s.jsx)(n.p,{children:"In some situations you want the settings to be driven by the client. For example when deploying applications using Docker compose if you have address to other containers within the compose file, you can reference them by their container name. In that case, you would like the setting to be set by the docker compose file rather than having to be manually set in Fig or use a default."}),"\n",(0,s.jsx)(n.p,{children:"In this case, we can use the client settings override feature. Fig reads environment variables using the same naming convention as the .NET environment variable configuration provider. The Fig client library will read matching environment variables on startup and send them along with the registration information. If client overrides are enabled on the API, those values will be used to update the setting value."}),"\n",(0,s.jsx)(n.h2,{id:"environment-variable-naming-convention",children:"Environment Variable Naming Convention"}),"\n",(0,s.jsxs)(n.p,{children:["Fig uses the standard .NET environment variable naming convention with ",(0,s.jsx)(n.code,{children:"__"})," as the delimiter for configuration sections:"]}),"\n",(0,s.jsx)(n.h3,{id:"simple-settings",children:"Simple Settings"}),"\n",(0,s.jsx)(n.p,{children:"For simple settings, use the setting name directly:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"environment:\n  - WebsiteAddress=http://bing.com\n"})}),"\n",(0,s.jsx)(n.h3,{id:"configuration-section-overrides",children:"Configuration Section Overrides"}),"\n",(0,s.jsxs)(n.p,{children:["If your setting uses a ",(0,s.jsx)(n.code,{children:"ConfigurationSectionOverride"})," attribute, the environment variable should match the full configuration path:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c#",children:'[Setting("The minimum log level", "Information")]\n[ConfigurationSectionOverride("Serilog:MinimumLevel", "Default")]\npublic string MinLogLevel { get; set; }\n'})}),"\n",(0,s.jsx)(n.p,{children:"The environment variable would be:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"environment:\n  - Serilog__MinimumLevel__Default=Warning\n"})}),"\n",(0,s.jsx)(n.h3,{id:"nested-settings",children:"Nested Settings"}),"\n",(0,s.jsxs)(n.p,{children:["For nested settings (using ",(0,s.jsx)(n.code,{children:"NestedSettingAttribute"}),"), use the path with ",(0,s.jsx)(n.code,{children:"__"})," as separator:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c#",children:'[NestedSetting]\npublic School School { get; set; }\n\n// In School class:\n[Setting("School name", "Default")]\npublic string Name { get; set; }\n'})}),"\n",(0,s.jsx)(n.p,{children:"The environment variable would be:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"environment:\n  - School__Name=Oxford\n"})}),"\n",(0,s.jsx)(n.h3,{id:"list-settings",children:"List Settings"}),"\n",(0,s.jsxs)(n.p,{children:["For ",(0,s.jsx)(n.code,{children:"List<string>"})," settings, use indexed environment variables:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"environment:\n  - StringList__0=FirstItem\n  - StringList__1=SecondItem\n  - StringList__2=ThirdItem\n"})}),"\n",(0,s.jsxs)(n.p,{children:["For lists of complex objects (",(0,s.jsx)(n.code,{children:"List<T>"}),"), include the property name after the index:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"environment:\n  - ComplexList__0__Name=First\n  - ComplexList__0__Value=100\n  - ComplexList__1__Name=Second\n  - ComplexList__1__Value=200\n"})}),"\n",(0,s.jsx)(n.h3,{id:"complex-object-settings-json",children:"Complex Object Settings (JSON)"}),"\n",(0,s.jsx)(n.p,{children:"For single complex object settings (serialized as JSON), use the property names:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"environment:\n  - ComplexObject__StringVal=MyString\n  - ComplexObject__IntVal=42\n"})}),"\n",(0,s.jsxs)(n.admonition,{title:"Limitation",type:"warning",children:[(0,s.jsxs)(n.p,{children:["When overriding complex object (JSON) settings via environment variables, all property values are treated as strings in the resulting JSON. This means numeric and boolean properties will be serialized as string values (e.g., ",(0,s.jsx)(n.code,{children:'"IntVal":"42"'})," instead of ",(0,s.jsx)(n.code,{children:'"IntVal":42'}),")."]}),(0,s.jsx)(n.p,{children:"If your application requires strict JSON type validation, consider using list settings or simple typed settings instead."})]}),"\n",(0,s.jsx)(n.h2,{id:"example-usage",children:"Example Usage"}),"\n",(0,s.jsx)(n.p,{children:"For example, imagine you have an application called ProductService with the following settings:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c#",children:'public class ProductService : SettingsBase\n{\n    public override string ClientDescription => "Sample Product Service";\n\n    [Setting("This is the address of a website", "http://www.google.com")]\n    public string WebsiteAddress { get; set; }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"You could then define your docker compose file like this:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"productserviceapp:\n    image: myProductServiceImage:latest\n    container_name: ProductServiceImage\n    environment:\n      - WebsiteAddress=http://bing.com\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If overrides are enabled for this client, the value '",(0,s.jsx)(n.a,{href:"http://bing.com",children:"http://bing.com"}),"' will be sent along with the registration of the client and will be used to update the value of WebsiteAddress."]}),"\n",(0,s.jsx)(n.h2,{id:"externally-managed-settings",children:"Externally Managed Settings"}),"\n",(0,s.jsxs)(n.p,{children:["When a client setting override is applied, the setting is automatically marked as ",(0,s.jsx)(n.a,{href:"/docs/next/features/externally-managed-settings",children:"externally managed"}),". This means:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The setting will appear as read-only in the Fig web application (with a padlock icon)"}),"\n",(0,s.jsx)(n.li,{children:"The change history will include details about which application set the value"}),"\n",(0,s.jsx)(n.li,{children:"Administrators can still unlock and edit the setting if needed, but the value will revert on the next client registration"}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"You can change the value in the Fig web application by unlocking the setting, but it will revert back to the override value when you next restart the client application. If that is undesirable, you can always turn off the client override feature."})}),"\n",(0,s.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(n.p,{children:"This feature is enabled by default but can be disabled in the fig configuration which is available when logged into the web application as an administrator."}),"\n",(0,s.jsx)(n.p,{children:"It is also possible to enter a regular expression there to define which clients will be allowed to override their settings and which will not. The regular expression is evaluated against the client name."})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453(e,n,i){i.d(n,{R:()=>r,x:()=>l});var t=i(96540);const s={},a=t.createContext(s);function r(e){const n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);