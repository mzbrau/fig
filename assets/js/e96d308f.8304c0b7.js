"use strict";(self.webpackChunkfig_documentation=self.webpackChunkfig_documentation||[]).push([[2912],{6597:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"features/client-secrets/client-secret-providers","title":"Client Secrets","description":"Fig uses a client secret to uniquely identify and authenticate each application instance that connects to the Fig configuration server. This secret is critical for securely associating configuration data and for protecting sensitive operations.","source":"@site/docs/features/28-client-secrets/1-client-secret-providers.md","sourceDirName":"features/28-client-secrets","slug":"/features/client-secrets/client-secret-providers","permalink":"/docs/next/features/client-secrets/client-secret-providers","draft":false,"unlisted":false,"editUrl":"https://github.com/mzbrau/fig/tree/main/doc/fig-documentation/docs/features/28-client-secrets/1-client-secret-providers.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"sidebar_label":"Client Secrets"},"sidebar":"tutorialSidebar","previous":{"title":"Client Secrets","permalink":"/docs/next/category/client-secrets"},"next":{"title":"Docker Client Secret Provider","permalink":"/docs/next/features/client-secrets/docker-secret-provider"}}');var n=t(4848),s=t(8453);const c={sidebar_position:1,sidebar_label:"Client Secrets"},o="Client Secrets",a={},l=[{value:"Purpose of the Client Secret",id:"purpose-of-the-client-secret",level:2},{value:"How Client Secret Providers Are Used",id:"how-client-secret-providers-are-used",level:2},{value:"Specifying Client Secrets Directly",id:"specifying-client-secrets-directly",level:2},{value:"Provider Order and Overrides",id:"provider-order-and-overrides",level:2},{value:"Available Client Secret Providers",id:"available-client-secret-providers",level:2},{value:"Writing Your Own Client Secret Provider",id:"writing-your-own-client-secret-provider",level:2},{value:"NuGet Package",id:"nuget-package",level:2}];function d(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"client-secrets",children:"Client Secrets"})}),"\n",(0,n.jsxs)(r.p,{children:["Fig uses a ",(0,n.jsx)(r.strong,{children:"client secret"})," to uniquely identify and authenticate each application instance that connects to the Fig configuration server. This secret is critical for securely associating configuration data and for protecting sensitive operations."]}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Client secrets should be a GUID"})," (e.g., ",(0,n.jsx)(r.code,{children:"b1a2c3d4-e5f6-7890-abcd-ef1234567890"}),") and must be the same across all running instances of an application. This ensures that all instances are recognized as the same logical client by the Fig server."]}),"\n",(0,n.jsx)(r.p,{children:"The secret is only known by the client and is passed to the API during registration, with the API storing a hash of the secret for the authentication of future requests."}),"\n",(0,n.jsx)(r.h2,{id:"purpose-of-the-client-secret",children:"Purpose of the Client Secret"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Authentication"}),": The client secret is used to authenticate the application with the Fig server."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Isolation"}),": Ensures that configuration and secrets are isolated per application instance."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Security"}),": Prevents unauthorized access to configuration data."]}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"how-client-secret-providers-are-used",children:"How Client Secret Providers Are Used"}),"\n",(0,n.jsxs)(r.p,{children:["When you configure Fig in your application, you specify a ",(0,n.jsx)(r.code,{children:"ClientSecretProvider"}),". This provider is responsible for retrieving (and, in development, possibly creating) the client secret for your application. The secret is then used by the Fig client library to authenticate with the Fig server."]}),"\n",(0,n.jsx)(r.p,{children:"You can specify a client secret provider when configuring Fig:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-csharp",children:'builder.Configuration.SetBasePath(GetBasePath())\n    .AddJsonFile("appsettings.json", optional: true, reloadOnChange: true)\n    .AddFig<Settings>(options =>\n    {\n        options.ClientName = "AspNetApi";\n        options.LoggerFactory = loggerFactory;\n        options.CommandLineArgs = args;\n        options.ClientSecretProviders = [new DockerSecretProvider()];\n    });\n'})}),"\n",(0,n.jsx)(r.h2,{id:"specifying-client-secrets-directly",children:"Specifying Client Secrets Directly"}),"\n",(0,n.jsxs)(r.p,{children:["For development or testing, you can specify the client secret directly using the ",(0,n.jsx)(r.code,{children:"ClientSecretOverride"})," setting. This can be provided via command line, or hard-coded in your configuration options. ",(0,n.jsx)(r.strong,{children:"This approach is not recommended for production use."})]}),"\n",(0,n.jsx)(r.p,{children:"Example (hard-coded):"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-csharp",children:'options.ClientSecretOverride = "b1a2c3d4-e5f6-7890-abcd-ef1234567890";\n'})}),"\n",(0,n.jsx)(r.p,{children:"You can also pass the client secret via command line for convenience in non-production scenarios."}),"\n",(0,n.jsx)(r.h2,{id:"provider-order-and-overrides",children:"Provider Order and Overrides"}),"\n",(0,n.jsxs)(r.p,{children:["The order of the ",(0,n.jsx)(r.code,{children:"ClientSecretProviders"})," list is important: Fig will try each provider in order until one returns a valid secret. You can control the order by arranging the providers in the list. Additionally, you can set an environment variable to override the order in which providers are tried, allowing for flexible configuration across environments."]}),"\n",(0,n.jsxs)(r.p,{children:["Add an environment variable called ",(0,n.jsx)(r.code,{children:"FIG_CLIENT_SECRET_PROVIDERS"})," and list the names of the secret providers (",(0,n.jsx)(r.code,{children:"Docker"}),", ",(0,n.jsx)(r.code,{children:"Dpapi"}),", ",(0,n.jsx)(r.code,{children:"Azure"}),", ",(0,n.jsx)(r.code,{children:"Aws"}),", ",(0,n.jsx)(r.code,{children:"Google"}),") in a csv format with the first one being the one that should be tried first. Only specify providers that are supported by your application (or a subset of them)."]}),"\n",(0,n.jsx)(r.h2,{id:"available-client-secret-providers",children:"Available Client Secret Providers"}),"\n",(0,n.jsx)(r.p,{children:"Fig provides several built-in client secret providers for different environments and cloud platforms:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"/docs/next/features/client-secrets/docker-secret-provider",children:"Docker Secret Provider"}),": Uses Docker secrets mounted in ",(0,n.jsx)(r.code,{children:"/run/secrets/"})," (Linux containers)."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"/docs/next/features/client-secrets/dpapi-secret-provider",children:"DPAPI Secret Provider"}),": Uses Windows DPAPI or environment variables (Windows environments)."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"/docs/next/features/client-secrets/azure-secret-provider",children:"Azure Key Vault Secret Provider"}),": Uses Azure Key Vault for secret storage and retrieval."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"/docs/next/features/client-secrets/aws-secret-provider",children:"AWS Secrets Manager Provider"}),": Uses AWS Secrets Manager for secret storage and retrieval."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"/docs/next/features/client-secrets/google-secret-provider",children:"Google Cloud Secret Manager Provider"}),": Uses Google Cloud Secret Manager for secret storage and retrieval."]}),"\n"]}),"\n",(0,n.jsx)(r.p,{children:"Each provider has its own NuGet package, configuration, and platform requirements. See the linked documentation for details."}),"\n",(0,n.jsx)(r.h2,{id:"writing-your-own-client-secret-provider",children:"Writing Your Own Client Secret Provider"}),"\n",(0,n.jsxs)(r.p,{children:["You can implement your own client secret provider by inheriting from the ",(0,n.jsx)(r.code,{children:"IClientSecretProvider"})," interface in the ",(0,n.jsx)(r.code,{children:"Fig.Client.Contracts"})," package. Your provider must implement the logic to retrieve (and optionally create) a client secret for your application."]}),"\n",(0,n.jsx)(r.p,{children:"Example skeleton:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-csharp",children:'using Fig.Client.Contracts;\n\npublic class MyCustomSecretProvider : IClientSecretProvider\n{\n    public Task<string> GetSecret(string clientName)\n    {\n        // Your logic to retrieve or create the secret\n        return Task.FromResult("my-secret-value");\n    }\n}\n'})}),"\n",(0,n.jsx)(r.p,{children:"You can then use your custom provider in the same way as the built-in providers."}),"\n",(0,n.jsx)(r.h2,{id:"nuget-package",children:"NuGet Package"}),"\n",(0,n.jsxs)(r.p,{children:["The ",(0,n.jsx)(r.code,{children:"Fig.Client.Contracts"})," project, which contains the ",(0,n.jsx)(r.code,{children:"IClientSecretProvider"})," interface and base classes, is published as a NuGet package. Add it to your project:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"dotnet add package Fig.Client.Contracts\n"})})]})}function h(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},8453:(e,r,t)=>{t.d(r,{R:()=>c,x:()=>o});var i=t(6540);const n={},s=i.createContext(n);function c(e){const r=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:c(e.components),i.createElement(s.Provider,{value:r},e.children)}}}]);