"use strict";(globalThis.webpackChunkfig_documentation=globalThis.webpackChunkfig_documentation||[]).push([[66],{21575(e,n,t){t.d(n,{A:()=>i});const i=t.p+"assets/images/validation-3389b1cc8cfd99182e431a76758a237b.png"},28453(e,n,t){t.d(n,{R:()=>l,x:()=>r});var i=t(96540);const a={},s=i.createContext(a);function l(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),i.createElement(s.Provider,{value:n},e.children)}},54836(e,n,t){t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"features/settings-management/validation","title":"Validation","description":"String, integer or long type settings can have custom regular expression that will be used to validate the setting. If a value is entered that does not match the regex then a custom message will be shown to the person configuring the setting and saving will not be allowed.","source":"@site/versioned_docs/version-3.x/features/settings-management/20-validation.md","sourceDirName":"features/settings-management","slug":"/features/settings-management/validation","permalink":"/docs/features/settings-management/validation","draft":false,"unlisted":false,"editUrl":"https://github.com/mzbrau/fig/tree/main/doc/fig-documentation/versioned_docs/version-3.x/features/settings-management/20-validation.md","tags":[],"version":"3.x","sidebarPosition":20,"frontMatter":{"sidebar_position":20},"sidebar":"tutorialSidebar","previous":{"title":"Valid Values (Dropdowns)","permalink":"/docs/features/settings-management/valid-values"},"next":{"title":"Value History","permalink":"/docs/features/settings-management/value-history"}}');var a=t(74848),s=t(28453);const l={sidebar_position:20},r="Validation",o={},d=[{value:"Usage",id:"usage",level:2},{value:"Class-level Validation",id:"class-level-validation",level:2},{value:"Appearance",id:"appearance",level:2},{value:"Overriding via Environment Variable",id:"overriding-via-environment-variable",level:2},{value:"Excluding Validation from Health Checks",id:"excluding-validation-from-health-checks",level:2},{value:"Additional Validation Attributes",id:"additional-validation-attributes",level:2},{value:"ValidateSqlServerConnectionString in Data Grids",id:"validatesqlserverconnectionstring-in-data-grids",level:3},{value:"Inclusion Parameter",id:"inclusion-parameter",level:3},{value:"Constraint Parameter",id:"constraint-parameter",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"validation",children:"Validation"})}),"\n",(0,a.jsx)(n.p,{children:"String, integer or long type settings can have custom regular expression that will be used to validate the setting. If a value is entered that does not match the regex then a custom message will be shown to the person configuring the setting and saving will not be allowed."}),"\n",(0,a.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'[Setting("This is a string", "Horse")]\n[Validation("[0-9a-zA-Z]{5,}", "Must have 5 or more characters")]\npublic string AStringSetting { get; set; } = null!;\n'})}),"\n",(0,a.jsx)(n.p,{children:"It is also possible to use some built in regular expressions for common validation checks. For example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'[Setting("This is a string", "Horse")]\n[Validation(ValidationType.NotEmpty)]\npublic string AStringSetting { get; set; } = null!;\n'})}),"\n",(0,a.jsx)(n.h2,{id:"class-level-validation",children:"Class-level Validation"}),"\n",(0,a.jsx)(n.p,{children:"You can also apply validation rules at the class level, which will automatically apply to properties of specified types, unless they already have their own validation attributes. This is useful when you want to enforce consistent validation rules across multiple properties of the same type."}),"\n",(0,a.jsxs)(n.p,{children:["You can exclude properties from validation using ",(0,a.jsx)(n.code,{children:"[Validation(ValidationType.None)]"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'// Apply validation to all string properties that don\'t have their own validation attribute\n[ValidationOfAllTypes(@"[^\\s]+", "Value cannot contain spaces", typeof(string))]\n// Apply validation to all int properties that don\'t have their own validation attribute\n[ValidationOfAllTypes(@"[1-9][0-9]*", "Must be a positive number", typeof(int))]\npublic class ApplicationSettings\n{\n    [Setting("Username")]\n    // Will use class-level validation for strings: no spaces allowed\n    public string Username { get; set; } = null!;\n    \n    [Setting("Password")]\n    // Override class-level validation with property-specific validation\n    [Validation(@"[a-zA-Z0-9]{8,}", "Password must be at least 8 alphanumeric characters")]\n    public string Password { get; set; } = null!;\n    \n    [Setting("Age")]\n    // Will use class-level validation for integers: must be positive\n    public int Age { get; set; }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"appearance",children:"Appearance"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"Validation",src:t(21575).A+"",width:"1828",height:"410"})}),"\n",(0,a.jsx)(n.h2,{id:"overriding-via-environment-variable",children:"Overriding via Environment Variable"}),"\n",(0,a.jsxs)(n.p,{children:["The validation value can be overridden using an environment variable. It should be in the format ",(0,a.jsx)(n.code,{children:"FIG_SettingName_VALIDATIONREGEX"})," and ",(0,a.jsx)(n.code,{children:"FIG_SettingName_VALIDATIONEXPLANATION"})]}),"\n",(0,a.jsx)(n.p,{children:"Use a value of 'null' to clear the current value."}),"\n",(0,a.jsx)(n.h2,{id:"excluding-validation-from-health-checks",children:"Excluding Validation from Health Checks"}),"\n",(0,a.jsxs)(n.p,{children:["By default, all ",(0,a.jsx)(n.code,{children:"[Validation]"})," attributes are also included in the ",(0,a.jsx)(n.a,{href:"/docs/features/health-checks",children:"Fig Health Check"}),". This means that if a setting does not pass validation, the application will be marked as unhealthy and potentially not sent any requests by the load balancer. If the validation is complex and there is a risk that a valid setting might be treated as invalid, you can exclude the validation from the health check."]}),"\n",(0,a.jsx)(n.p,{children:"For example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:"[Validation(ValidationType.NotEmpty, false)]\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Alternatively, you can use a ",(0,a.jsx)(n.a,{href:"/docs/features/settings-management/display-scripts",children:"Display Script"})," instead as they are not run as part of a health check."]}),"\n",(0,a.jsx)(n.h2,{id:"additional-validation-attributes",children:"Additional Validation Attributes"}),"\n",(0,a.jsxs)(n.p,{children:["Sometimes validating values using regular expressions is difficult and a different approach is required. ",(0,a.jsx)(n.a,{href:"/docs/features/settings-management/display-scripts",children:"Display Scripts"})," can be used but require some effort to write."]}),"\n",(0,a.jsx)(n.p,{children:"There are some pre-built attributes that use display scripts behind the scenes but also add the benifit of client side validation in the health check. These are:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"[ValidateIsBetween(3, 8)]"})," - Validates the number is between the two provided values. Use ",(0,a.jsx)(n.code,{children:"Inclusion.Inclusive"})," (default) to include the boundary values or ",(0,a.jsx)(n.code,{children:"Inclusion.Exclusive"})," to exclude them.","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Example: ",(0,a.jsx)(n.code,{children:"[ValidateIsBetween(3, 8, Inclusion.Exclusive)]"})," validates that the value is greater than 3 and less than 8."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"[ValidateGreaterThan(5)]"})," - validates the number is greater than the provided value. Use ",(0,a.jsx)(n.code,{children:"Inclusion.Exclusive"})," (default) for greater than or ",(0,a.jsx)(n.code,{children:"Inclusion.Inclusive"})," for greater than or equal to.","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Example: ",(0,a.jsx)(n.code,{children:"[ValidateGreaterThan(5, Inclusion.Inclusive)]"})," validates that the value is greater than or equal to 5."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"[ValidateLessThan(6)]"})," - validates the number is less than the provided value. Use ",(0,a.jsx)(n.code,{children:"Inclusion.Exclusive"})," (default) for less than or ",(0,a.jsx)(n.code,{children:"Inclusion.Inclusive"})," for less than or equal to.","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Example: ",(0,a.jsx)(n.code,{children:"[ValidateLessThan(6, Inclusion.Inclusive)]"})," validates that the value is less than or equal to 6."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"[ValidateSqlServerConnectionString]"})," - validates the basic components of an SQL connection string."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"[ValidateCount(Constraint.Exactly, 5)]"})," - validates that a List or collection contains exactly the specified number of items. Use ",(0,a.jsx)(n.code,{children:"Constraint.AtLeast"})," to validate minimum count, ",(0,a.jsx)(n.code,{children:"Constraint.AtMost"})," to validate maximum count, or ",(0,a.jsx)(n.code,{children:"Constraint.Between"})," to validate a range.","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Example: ",(0,a.jsx)(n.code,{children:"[ValidateCount(Constraint.AtLeast, 3)]"})," validates that the collection contains at least 3 items."]}),"\n",(0,a.jsxs)(n.li,{children:["Example: ",(0,a.jsx)(n.code,{children:"[ValidateCount(Constraint.Between, 2, 8)]"})," validates that the collection contains between 2 and 8 items (inclusive)."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"validatesqlserverconnectionstring-in-data-grids",children:"ValidateSqlServerConnectionString in Data Grids"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"[ValidateSqlServerConnectionString]"})," can be used on data grid settings as well as regular string settings."]}),"\n",(0,a.jsxs)(n.p,{children:["Use ",(0,a.jsx)(n.code,{children:"UsedInDataGrid = true"})," when the target setting is a data grid:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'[Setting("Connection strings")]\n[ValidateSqlServerConnectionString(UsedInDataGrid = true)]\npublic List<string> ConnectionStrings { get; set; } = [];\n'})}),"\n",(0,a.jsxs)(n.p,{children:["For multi-column data grids, set ",(0,a.jsx)(n.code,{children:"DataGridFieldName"})," to the column that contains the SQL Server connection string:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'[Setting("Database connections")]\n[ValidateSqlServerConnectionString(UsedInDataGrid = true, DataGridFieldName = "ConnectionString")]\npublic List<DatabaseRow> DatabaseConnections { get; set; } = [];\n'})}),"\n",(0,a.jsxs)(n.p,{children:["If ",(0,a.jsx)(n.code,{children:"DataGridFieldName"})," is not provided, the default field is ",(0,a.jsx)(n.code,{children:"Values"})," (the default column name used by ",(0,a.jsx)(n.code,{children:"List<string>"})," data grids)."]}),"\n",(0,a.jsx)(n.h3,{id:"inclusion-parameter",children:"Inclusion Parameter"}),"\n",(0,a.jsxs)(n.p,{children:["The validation attributes that compare numeric values (",(0,a.jsx)(n.code,{children:"ValidateIsBetween"}),", ",(0,a.jsx)(n.code,{children:"ValidateGreaterThan"}),", and ",(0,a.jsx)(n.code,{children:"ValidateLessThan"}),") use an ",(0,a.jsx)(n.code,{children:"Inclusion"})," enum parameter to specify whether boundary values should be included in the validation:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"Inclusion.Inclusive"})," - Includes the boundary value(s) in the valid range"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"Inclusion.Exclusive"})," - Excludes the boundary value(s) from the valid range"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"For example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:"[ValidateIsBetween(0, 100, Inclusion.Inclusive)]  // Valid range: 0 <= value <= 100\n[ValidateIsBetween(0, 100, Inclusion.Exclusive)]  // Valid range: 0 < value < 100\n\n[ValidateGreaterThan(10, Inclusion.Inclusive)]    // Valid range: value >= 10\n[ValidateGreaterThan(10, Inclusion.Exclusive)]    // Valid range: value > 10\n\n[ValidateLessThan(50, Inclusion.Inclusive)]       // Valid range: value <= 50  \n[ValidateLessThan(50, Inclusion.Exclusive)]       // Valid range: value < 50\n"})}),"\n",(0,a.jsx)(n.h3,{id:"constraint-parameter",children:"Constraint Parameter"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"ValidateCount"})," attribute uses a ",(0,a.jsx)(n.code,{children:"Constraint"})," enum parameter to specify how the collection count should be validated:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"Constraint.Exactly"})," - The collection must contain exactly the specified number of items"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"Constraint.AtLeast"})," - The collection must contain at least the specified number of items"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"Constraint.AtMost"})," - The collection must contain at most the specified number of items"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"Constraint.Between"})," - The collection must contain between the specified minimum and maximum number of items (inclusive)"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"For example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:"[ValidateCount(Constraint.Exactly, 5)]   // Collection must have exactly 5 items\n[ValidateCount(Constraint.AtLeast, 3)]   // Collection must have 3 or more items\n[ValidateCount(Constraint.AtMost, 10)]   // Collection must have 10 or fewer items\n[ValidateCount(Constraint.Between, 2, 8)] // Collection must have between 2 and 8 items (inclusive)\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Note that all the new validation attributes rely on ",(0,a.jsx)(n.a,{href:"/docs/features/settings-management/display-scripts",children:"Display Scripts"})," to work in the web application. The display scripts needs to be enabled within the configuration."]}),"\n",(0,a.jsx)(n.admonition,{title:"Excluding from health check",type:"note",children:(0,a.jsx)(n.p,{children:"All of these validation operators have the option to explicitly exclude them from health checks. This could be useful in the case where a valid value might fail the validation due to complexities of the validation process or lack of understanding of the requirements."})}),"\n",(0,a.jsx)(n.admonition,{title:"Suggestions",type:"info",children:(0,a.jsx)(n.p,{children:"If you have suggestions for other attributes that could perform validation that would be difficult with a regular expression, please raise a GitHub ticket."})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);