"use strict";(self.webpackChunkfig_documentation=self.webpackChunkfig_documentation||[]).push([[640],{6835:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>d,frontMatter:()=>h,metadata:()=>i,toc:()=>r});const i=JSON.parse('{"id":"features/health-checks","title":"Health Checks","description":"When the fig client is registered in the program.cs file, it enables health checks for an ASP.NET application. Health Checks provide a mechanism to query an application and understand its health state.","source":"@site/docs/features/18-health-checks.md","sourceDirName":"features","slug":"/features/health-checks","permalink":"/docs/next/features/health-checks","draft":false,"unlisted":false,"editUrl":"https://github.com/mzbrau/fig/tree/main/doc/fig-documentation/docs/features/18-health-checks.md","tags":[],"version":"current","sidebarPosition":18,"frontMatter":{"sidebar_position":18,"sidebar_label":"Health Checks"},"sidebar":"tutorialSidebar","previous":{"title":"Compact View","permalink":"/docs/next/features/compact-view"},"next":{"title":"Change Message","permalink":"/docs/next/features/change-message"}}');var s=n(4848),a=n(8453);const h={sidebar_position:18,sidebar_label:"Health Checks"},c="Health Checks",l={},r=[{value:"Inspecting Health",id:"inspecting-health",level:2},{value:"Health States",id:"health-states",level:2},{value:"Fig Configuration Health Check",id:"fig-configuration-health-check",level:2},{value:"Architecture",id:"architecture",level:2}];function o(e){const t={a:"a",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"health-checks",children:"Health Checks"})}),"\n",(0,s.jsxs)(t.p,{children:["When the fig client is registered in the program.cs file, it enables ",(0,s.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/aspnet/core/host-and-deploy/health-checks?view=aspnetcore-9.0",children:"health checks"})," for an ASP.NET application. Health Checks provide a mechanism to query an application and understand its health state."]}),"\n",(0,s.jsx)(t.p,{children:"Typically, applications should include health checks for all components as part of the overall health check. This might include third party dependencies such as databases, message busses, caches, or API's. Each of these can be registered as their own health check and are added as components to the overall heath of the application."}),"\n",(0,s.jsx)(t.p,{children:"The Fig.Client internally queries the health check on every poll cycle and sends the result to the API. This information is then used for event log and web hook generation when the health state changes."}),"\n",(0,s.jsx)(t.p,{children:"The information is also then available within the web application."}),"\n",(0,s.jsx)(t.h2,{id:"inspecting-health",children:"Inspecting Health"}),"\n",(0,s.jsx)(t.p,{children:"Health is displayed in 2 places:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"In the main settings page - here an icon shows an aggregated state of all running instances of an application. All instances must be healthy in order for the icon to show healthy. An additional aggregated state of all instances is shown at the top."}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.img,{alt:"Health Checks",src:n(689).A+"",width:"2505",height:"507"}),(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.em,{children:"Aggregated health checks show the status of all running instances"})]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"In the connected clients page - Here an icon is shown for each running instances. Instances can be expanded to show all health details."}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.img,{alt:"alt text",src:n(6615).A+"",width:"2558",height:"805"}),(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.em,{children:"You can see the health of each component within the application"})]}),"\n",(0,s.jsx)(t.h2,{id:"health-states",children:"Health States"}),"\n",(0,s.jsx)(t.p,{children:"Health may be one of the following:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Healthy (green)"})," - everything is working as expected"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Unhealthy (red)"})," - the application is not working as expected"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Degraded (orange)"})," - the application is running but with limited functionality"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Unknown (grey)"})," - the application is running but not providing health information. This might be because it is running an earlier version of the Fig.Client library or has not registered fig correctly."]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"fig-configuration-health-check",children:"Fig Configuration Health Check"}),"\n",(0,s.jsx)(t.p,{children:"In addition to reading existing health checks, Fig also registers its own health check. The health check is designed to show that the application is configured correctly."}),"\n",(0,s.jsx)(t.p,{children:"To decide this, it does the following:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Calls the ",(0,s.jsx)(t.code,{children:"GetValidationErrors()"})," method which must be implemented in your settings class. This method provides an opportunity to perform complex validations on settings including checking relationships between settings and return their state."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Runs all ",(0,s.jsx)(t.code,{children:"[Validation]"})," attributes on any settings where they are present. It is possible to exclude settings from this validation, see ",(0,s.jsx)(t.a,{href:"/docs/next/features/settings-management/validation",children:"Validation"})," for more details."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Calls the ",(0,s.jsx)(t.code,{children:"GetValidationWarnings()"})," method which is optional to be implemented in your settings class. This method provides the opportunity to perform complex validation on settings. If there are validation warnings and no validation errors or validation attributes, the health check will be ",(0,s.jsx)(t.strong,{children:"Degraded"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Note for performance reasons, the health check result is cached and only checked after settings have changed."}),"\n",(0,s.jsx)(t.h2,{id:"architecture",children:"Architecture"}),"\n",(0,s.jsx)(t.p,{children:"The health check architecture is shown below:"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.img,{alt:"architecture",src:n(1194).A+"",width:"1610",height:"654"}),(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.em,{children:"Health Check Architecture"})]})]})}function d(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},1194:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/fig-health-checks-26d0016fe984f46855aa877a8c8b3c71.png"},6615:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/health-checks-client-f33f3297b0b07a707109133570bc2a8a.png"},689:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/health-checks-settings-3ce1363b3b626b8426771c958cf42726.png"},8453:(e,t,n)=>{n.d(t,{R:()=>h,x:()=>c});var i=n(6540);const s={},a=i.createContext(s);function h(e){const t=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:h(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);